function series impute (const series y, const string method)
    /* Public function for imputing missing values of 'y' by some method.
    return: series, imputed series. */

    string prefix = $datatype == 3 ? "p" : ""
    string function_name = sprintf("%s%s", prefix, method_to_function_map(method))
    series ret = missing(y) ? feval(function_name, y) : y

    return ret
end function


function string method_to_function_map (const string method)
    /* Mapping method to function name being called.
    return: string, Function name being called. */

    bundle Map = _(\
                   min = "min",\
                   max = "max",
                   mean = "mean",
                   median = "quantile",
                   ffill = "first",
                   bfill = "last",
                   mode = "mode",
                   sts= "sts"\
                   )

    return Map["@method"]
end function


